<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>영양학 퀴즈</title>
    <style>
        body {
            font-family: 'Comic Sans MS', sans-serif;
            background-color: #f0f8ff;
            color: #333;
            text-align: center;
        }

        .quiz-container {
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
            border: 2px solid #ccc;
            border-radius: 10px;
            background-color: #ffffff;
        }

        .progress {
            display: inline-block;
            background-color: #ddd;
            height: 20px;
            border-radius: 10px;
            margin: 10px;
        }

        .progress-inner {
            background-color: #ff4500;
            height: 100%;
            border-radius: 10px;
        }

        .results {
            margin-top: 20px;
            text-align: left;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 10px;
            background-color: #f9f9f9;
        }
    </style>
</head>
<body>
    <div class="quiz-container">
        <h1>영양학 퀴즈</h1>
        <div class="progress" style="width: 100%;">
            <div id="progressInner" class="progress-inner" style="width: 0%;"></div>
        </div>
        <p id="questionText">여기에 질문이 표시됩니다.</p>
        <input type="text" id="answerInput" placeholder="정답을 입력하세요" />
        <button id="checkButton" onclick="checkAnswer()">정답 확인</button>
        <p id="feedback">정답을 입력하세요.</p>

        <div class="results" id="results">
            <!-- 결과 표시 영역 -->
        </div>
    </div>

    <script>
        // 쿠키 가져오기
        function getCookie(name) {
            const value = "; " + document.cookie;
            const parts = value.split("; " + name + "=");
            if (parts.length === 2) return parts.pop().split(";").shift();
            return null;
        }

        // 쿠키 설정하기
        function setCookie(name, value, days) {
            const expires = new Date();
            expires.setTime(expires.getTime() + (days * 24 * 60 * 60 * 1000));
            document.cookie = `${name}=${value};expires=${expires.toUTCString()};path=/`;
        }

        const questions = [
            {
                question: '칼슘이 풍부한 음식은?',
                answer: '우유',
                hint: '젖소가 제공합니다.'
            },
            {
                question: '단백질이 가장 많이 함유된 음식은?',
                answer: '닭고기',
                hint: '이것은 흔히 치킨으로 만들어지며, 닭에서 나옵니다.'
            },
            {
                question: '칼슘이 풍부한 음식은?',
                answer: '우유',
                hint: '이 음료는 젖소에서 생산되며, 주로 아침 식사와 함께 제공됩니다.'
            },
            {
                question: '비타민C가 많이 함유된 과일은?',
                answer: '레몬',
                hint: '새콤합니다.'
            },
            {
                question: '탄수화물이 우리 몸에 기여하는 것은?',
                answer: '에너지',
                hint: '레드불.'
            },
            {
                question: '당을 과다 섭취하면 생기는 병은?',
                answer: '당뇨',
                hint: '인슐린 저항성이 떨어집니다.'
            },
            {
                question: '하루 권장 섭취 물의 양은? 단위(L)',
                answer: '2',
                hint: '큰 생수병.'
            }
        ];

        const maxQuestionsPerDay = 3; // 하루 최대 문제 수 제한

        let correctAnswers = 0;
        let attempts = 0;
        let currentQuestionAttempts = 0;
        let currentQuestionIndex = -1;

        const today = new Date().toISOString().split('T')[0]; // 날짜 정보만 가져오기
        const quizAttempts = getCookie('quizAttempts') || '{}'; // 쿠키에서 시도 횟수 가져오기

        const parsedAttempts = JSON.parse(quizAttempts);

        // 오늘 이미 3번 풀었는지 확인
        if (parsedAttempts[today] && parsedAttempts[today] >= maxQuestionsPerDay) {
            document.getElementById('feedback').innerText = '오늘은 이미 3문제를 풀었습니다.';
            document.getElementById('checkButton').disabled = true;
            document.getElementById('answerInput').disabled = true;
        } else {
            getNextQuestion();
        }

        function getNextQuestion() {
            currentQuestionAttempts = 0;
            currentQuestionIndex = Math.floor(Math.random() * questions.length);
            displayQuestion();
        }

        function displayQuestion() {
            const questionText = document.getElementById('questionText');
            questionText.innerText = questions[currentQuestionIndex].question;
        }

        function checkAnswer() {
            const answerInput = document.getElementById('answerInput').value.trim();
            const feedback = document.getElementById('feedback');

            currentQuestionAttempts++; // 시도 횟수 증가

            if (answerInput.toLowerCase() === questions[currentQuestionIndex].answer.toLowerCase()) {
                correctAnswers++;
                feedback.innerText = `정답입니다! (시도 횟수: ${currentQuestionAttempts})`;

                // 문제 풀기 수 카운트
                const today = new Date().toISOString().split('T')[0]; // 날짜 정보만 가져오기
                const parsedAttempts = JSON.parse(getCookie('quizAttempts') || '{}');
                parsedAttempts[today] = (parsedAttempts[today] || 0) + 1;
                setCookie('quizAttempts', JSON.stringify(parsedAttempts), 1);

                const progressInner = document.getElementById('progressInner');
                const progressPercentage = (parsedAttempts[today] / maxQuestionsPerDay) * 100;
                progressInner.style.width = `${progressPercentage}%`;

                if (parsedAttempts[today] >= maxQuestionsPerDay) {
                    document.getElementById('checkButton').disabled = true;
                    document.getElementById('answerInput').disabled = true;
                    document.getElementById('answerInput').value = ''; // 입력 필드 비우기
                } else {
                    getNextQuestion(); // 다음 문제로 이동
                }
            } else {
                feedback.innerText = `오답입니다. 힌트: ${questions[currentQuestionIndex].hint}`;
            }
        }
    </script>
</body>
</html>
